namespace :cb do
  namespace :iapd do
    desc 'Import IAFs'
    task :import_iafs => :environment do
      import_from_csv(
        :filename => 'db/data/investment_advisors/latest_sec_reg_adv_report.csv'
      ) do |map|
        iaf = InvestmentAdvisorFirm.new
        loc = Location.new
          iaf.crd_number                                  = map[:crd_number]
          iaf.sec_number                                  = map[:sec_number]
          iaf.name                                        = map[:name]
          iaf.legal_name                                  = map[:legal_name]
          iaf.current_status                              = map[:current_status]
          iaf.status_eff_date                             = map[:status_eff_date]
          iaf.last_adv_filing_date                        = map[:last_adv_filing_date]
          iaf.url                                         = map[:url]
          iaf.assets_gt_1b                                = map['1O']
          iaf.sec_reg_large_advisory_firm                 = map['2A(1)']
          #iaf.sec_reg_mid_advisory_firm                   = map['2A(2)']
          iaf.sec_reg_main_office_in_wy                   = map['2A(3)']
          iaf.sec_reg_main_office_outside_us              = map['2A(4)']
          iaf.sec_reg_adviser_to_investment_co            = map['2A(5)']
          iaf.sec_reg_adviser_to_biz_dev_co               = map['2A(6)']
          iaf.sec_reg_pension_consultant                  = map['2A(7)']
          iaf.sec_reg_newly_formed                        = map['2A(9)']
          iaf.sec_reg_multi_state                         = map['2A(10)']
          iaf.sec_reg_internet_adviser                    = map['2A(11)']
          iaf.sec_reg_no_longer_sec_eligible              = map['2A(12)']
          iaf.organization                                = map['3A']
          iaf.organization_other                          = map['3A-Other']
          iaf.org_state                                   = map['3C-State']
          iaf.org_country                                 = map['3C-Country']
          iaf.num_employees                               = map['5a']
          iaf.num_advisers                                = map['5B(1)']
          iaf.num_broker_dealer_reps                      = map['5B(2)']
          iaf.num_iars                                    = map['5B(3)']
          iaf.num_iars_for_other_company                  = map['5B(4)']
          iaf.num_insurance_agents                        = map['5B(6)']
          iaf.num_solicit_clients                         = map['5B(6)']
          iaf.num_clients                                 = map['5C(1)']
          iaf.num_clients_more_than_100                   = map['5C(1)-More']
          iaf.percent_clients_non_us                      = map['5C(2)']
          iaf.percent_clients_individuals                 = map['5D(1)(a)']
          iaf.percent_clients_high_net_worth_individuals  = map['5D(1)(b)']
          iaf.percent_clients_banking_or_thrifts          = map['5D(1)(c)']
          iaf.percent_clients_investment_comps            = map['5D(1)(d)']
          iaf.percent_clients_biz_dev_comps               = map['5D(1)(e)']
          iaf.percent_clients_pooled_invest_vehicles      = map['5D(1)(f)']
          iaf.percent_clients_pension_plans               = map['5D(1)(g)']
          iaf.percent_clients_charities                   = map['5D(1)(h)']
          iaf.percent_clients_non_listed_comps            = map['5D(1)(i)']
          iaf.percent_clients_state_or_muni_govs          = map['5D(1)(j)']
          iaf.percent_clients_other_invest_advisers       = map['5D(1)(k)']
          iaf.percent_clients_other_insurance_comps       = map['5D(1)(l)']
          iaf.percent_clients_other                       = map['5D(1)(m)']
           iaf.comp_percent_assets                        = map['5E(1)']
           iaf.comp_hourly_rate                           = map['5E(2)']
           iaf.comp_sub_fee                               = map['5E(3)']
           iaf.comp_fixed_fee                             = map['5E(4)']
           iaf.comp_commission                            = map['5E(5)']
           iaf.comp_perf_fee                              = map['5E(6)']
          iaf.comp_other                                  = map['5E(7)']
          iaf.manage_portfolios                           = map['5F(1)']
          iaf.amount_under_management_desc                = map['5F(2)(a)']
          iaf.accounts_under_management_desc              = map['5F(2)(d)']
          iaf.amount_under_management_non_desc            = map['5F(2)(b)']
          iaf.accounts_under_management_non_desc          = map['5F(2)(e)']
          iaf.amount_under_management_total               = map['5F(2)(c)']
          iaf.accounts_under_management_total             = map['5F(2)(f)']
          iaf.service_financial_planning                  = map['5G(1)']
          iaf.service_ind_portfolio_management            = map['5G(2)']
          iaf.service_inv_comp_portfolio_management       = map['5G(3)']
          iaf.service_pooled_inv_portfolio_management     = map['5G(4)']
          iaf.service_inst_client_portfolio_management    = map['5G(5)']
          iaf.service_pension_consulting                  = map['5G(6)']
          iaf.service_select_advisers                     = map['5G(7)']
          iaf.service_publication                         = map['5G(8)']
          iaf.service_security_rating                     = map['5G(9)']
          iaf.service_market_timing                       = map['5G(10)']
          iaf.service_education                           = map['5G(11)']
          iaf.service_other                               = map['5G(12)']
          iaf.service_ind_portfolio_management_num_clients = map['5H']
          iaf.activity_broker_dealer                      = map['6A(1)']
          iaf.activity_reg_rep_broker_dealer              = map['6A(2)']
          iaf.activity_commodity_trading                  = map['6A(3)']
          iaf.activity_futures_commission                 = map['6A(4)']
          iaf.activity_real_estate                        = map['6A(5)']
          iaf.activity_insurance                          = map['6A(6)']
          iaf.activity_bank                               = map['6A(7)']
          iaf.activity_trust                              = map['6A(8)']
          iaf.activity_muni_adviser                       = map['6A(9)']
          iaf.activity_security_swap_dealer               = map['6A(10)']
          iaf.activity_security_swap_participant          = map['6A(11)']
          iaf.activity_accountant                         = map['6A(12)']
          iaf.activity_law                                = map['6A(13)']
          iaf.activity_other                              = map['6A(14)']
          iaf.custody_cash                                = map['9A(1)(a)']
          iaf.custody_securities                          = map['9A(1)(b)']
          iaf.custody_total_amount                        = map['9A(2)(a)']
          iaf.custody_total_clients                       = map['9A(2)(b)']
          iaf.custody_qualified_custodian                 = map['9C(1)']
          iaf.custody_independent_audit                   = map['9C(2)']
          iaf.custody_independent_examination             = map['9C(3)']
          iaf.custody_independent_control_report          = map['9C(4)']
          iaf.disc_felony_conviction                      = map['11A(1)']
          iaf.disc_felony_charges                         = map['11A(2)']
          iaf.disc_investment_misdemeanor_conviction      = map['11B(1)']
          iaf.disc_investment_misdemeanor_charges         = map['11B(2)']
          iaf.disc_sec_false_statement                    = map['11C(1)']
          iaf.disc_sec_reg_violation                      = map['11C(2)']
          iaf.disc_sec_cause_investment_auth_revoke       = map['11C(3)']
          iaf.disc_sec_investment_order                   = map['11C(4)']
          iaf.disc_sec_civil_penalty                      = map['11C(5)']
          iaf.disc_fed_false_statement                    = map['11D(1)']
          iaf.disc_fed_reg_violation                      = map['11D(2)']
          iaf.disc_fed_cause_investment_auth_revoke       = map['11D(3)']
          iaf.disc_fed_investment_order                   = map['11D(4)']
          iaf.disc_fed_civil_penalty                      = map['11D(5)']
          iaf.disc_org_false_statement                    = map['11E(1)']
          iaf.disc_org_reg_violation                      = map['11E(2)']
          iaf.disc_org_cause_investment_auth_revoke       = map['11E(3)']
          iaf.disc_org_investment_order                   = map['11E(4)']
          iaf.disc_revoked_authority                      = map['11F']
          iaf.disc_current_proceedings                    = map['11G']
          iaf.disc_court_enjoined                         = map['11H(1)(a)']
          iaf.disc_court_reg_violations                   = map['11H(1)(b)']
          iaf.disc_court_civil_penalty                    = map['11H(1)(c)']
          iaf.disc_court_proceedings                      = map['11H(2)']

        iaf.save

          loc.addressable_type                            = 'InvestmentAdvisorFirm'
          loc.addressable_id                              = iaf.id
          loc.address_1                                   = map[:address_1]
          loc.address_2                                   = map[:address_2]
          loc.address_state                               = map[:address_state]
          loc.address_city                                = map[:address_city]
          loc.address_zip                                 = map[:address_zip]
          loc.address_country                             = map[:address_country]
          loc.phone                                       = map[:phone]
          loc.fax                                         = map[:fax]
          loc.mail_address_1                              = map[:mail_address_1]
          loc.mail_address_2                              = map[:mail_address_2]
          loc.mail_address_state                          = map[:mail_address_state]
          loc.mail_address_city                           = map[:mail_address_city]
          loc.mail_address_zip                            = map[:mail_address_zip]
          loc.mail_address_country                        = map[:mail_address_country]
          loc.url                                         = map[:url]

        loc.save

      end
    end
  end
end